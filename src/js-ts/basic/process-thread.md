# 进程与线程的概念

## 进程

程序的一次执行，它占有一片独有的内存空间

## 线程

是进程内的一个独立执行单元，是 `CPU` 的最小调度单元

### 单线程

一个进程内有一个线程，这个线程也叫做主线程。

- `Node.js` 虽然是单线程模型，但是其基于事件驱动、异步非阻塞模式，可以应用于高并发场景，避免了线程创建、线程之间上下文切换所产生的资源开销

- 需要注意，单线程不适用大量计算，`CPU`耗时操作

### 多线程

一个进程内有多个线程，同一进程中的多条线程将共享该进程中的全部系统资源。

`Node.js` 在多核 `CPU` 系统上，可以通过 `child_process.fork` 开启多个进程（`Node.js` 在 `v0.8` 版本之后新增了 `Cluster` 来实现多进程架构） ，即 `多进程` + `单线程` 模式。注意：开启多进程不是为了解决高并发，主要是解决了单进程模式下 `Node.js` `CPU` 利用率不足的情况，充分利用多核 `CPU` 的性能。

## 浏览器

`chrome` 浏览器是多进程的，每当打开一个 `tab` 页相当于创建了一个渲染进程，每个渲染进程又是多线程的，分为：

- `GUI` 渲染线程：

  - 负责渲染浏览器界面，解析 `html`、`css`，构建 `DOM` 树和 `RenderObject` 树，布局和绘制等
  - 当页面重绘(`Repaint`)、或者回流`Repaint`

- `JS` 引擎线程：
  - 也称 `JS` 内核，负责处理 `javascript` 脚本，例如 V8 引擎。
  - `JS` 是单线程的

`GUI` 渲染线程与 `JS` 引擎线程是互斥的，当 `JS` 引擎执行时 `GUI` 线程会被挂起，`GUI` 更新会被保存在一个队列中等到 `JS` 引擎空闲时立即被执行;如果 `JS` 执行的时间过长，会导致页面渲染被阻塞。

## 参考

[Node.js 进阶之进程与线程](https://zhuanlan.zhihu.com/p/94613627)
